
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–∏ –ø—Ä–µ–¥–º–µ—Ç—ã</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
        }
        .loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #0a0a0a; display: flex; align-items: center;
            justify-content: center; z-index: 9999; transition: opacity 0.5s;
        }
        .loader.hidden { opacity: 0; visibility: hidden; }
        .spinner {
            width: 60px; height: 60px; border: 4px solid rgba(255,255,255,0.1);
            border-top-color: #ffffff; border-radius: 50%; animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .container { padding: 15px; padding-bottom: 80px; max-width: 600px; margin: 0 auto; }
        .header-card {
            background: linear-gradient(135deg, #1a1a1a 0%, #0f0f0f 100%);
            padding: 20px; border-radius: 16px; margin-bottom: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.7);
            border: 1px solid rgba(255,255,255,0.08); text-align: center;
        }
        .header-icon { font-size: 48px; margin-bottom: 10px; }
        .header-title { font-size: 24px; font-weight: 900; margin-bottom: 8px; }
        .header-subtitle { font-size: 13px; opacity: 0.5; }
        .items { display: grid; gap: 12px; }
        .item {
            background: linear-gradient(135deg, #1a1a1a 0%, #0f0f0f 100%);
            border-radius: 16px; overflow: hidden;
            border: 1px solid rgba(255,255,255,0.08); transition: all 0.3s;
        }
        .item:active { transform: scale(0.98); }
        .item-header { padding: 40px 15px; text-align: center; font-size: 48px; position: relative; }
        .item-icon { filter: drop-shadow(0 6px 12px rgba(0,0,0,0.3)); }
        .item-number {
            position: absolute; top: 10px; left: 10px;
            background: rgba(255,255,255,0.1); padding: 6px 12px;
            border-radius: 20px; font-size: 12px; font-weight: 700;
        }
        .item-body { padding: 15px; }
        .item-title { font-size: 16px; font-weight: 800; margin-bottom: 6px; }
        .item-desc { opacity: 0.5; font-size: 11px; margin-bottom: 12px; }
        .claim-btn {
            width: 100%; padding: 12px; border-radius: 12px; border: none;
            font-size: 13px; font-weight: 700; cursor: pointer;
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white; text-transform: uppercase; letter-spacing: 0.5px;
            transition: all 0.3s;
        }
        .claim-btn:active { transform: scale(0.97); }
        .empty-state { text-align: center; padding: 80px 20px; }
        .empty-icon { font-size: 80px; margin-bottom: 20px; opacity: 0.3; }
        .empty-title { font-size: 22px; font-weight: 700; margin-bottom: 12px; }
        .empty-desc { opacity: 0.5; font-size: 14px; line-height: 1.6; }
        .toast {
            position: fixed; bottom: -100px; left: 50%; transform: translateX(-50%);
            background: #1a1a1a; padding: 14px 20px; border-radius: 12px;
            display: flex; align-items: center; gap: 10px; transition: bottom 0.3s;
            z-index: 10000; box-shadow: 0 6px 24px rgba(0,0,0,0.6);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .toast.show { bottom: 25px; }
        .toast.success { border-color: #4CAF50; }
        .toast.error { border-color: #f44336; }
    </style>
</head>
<body>
    <div class="loader" id="loader"><div class="spinner"></div></div>
    <div class="container">
        <div class="header-card">
            <div class="header-icon">üì¶</div>
            <div class="header-title">–ú–æ–∏ –ø—Ä–µ–¥–º–µ—Ç—ã</div>
            <div class="header-subtitle">–ù–∞–∂–º–∏—Ç–µ "–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä" –¥–ª—è –≤—ã–¥–∞—á–∏</div>
        </div>
        <div class="items" id="inventory"></div>
    </div>
    <div class="toast" id="toast">
        <span id="toastIcon">‚úÖ</span>
        <span id="toastText">–£—Å–ø–µ—à–Ω–æ!</span>
    </div>
    <script>
        let tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        let USER_ID = '';
        let CUSTOM_ID = '';
        let INVENTORY = [];

        const ITEMS = [
            { id: 'fps', icon: 'üìÅ', name: '–§–∞–π–ª 90 FPS', gradient: 'linear-gradient(135deg, #667eea, #764ba2)' },
            { id: 'pc', icon: 'üñ•', name: '–ú–æ–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ –ü–ö', gradient: 'linear-gradient(135deg, #f093fb, #f5576c)' },
            { id: 'sens', icon: '‚öôÔ∏è', name: '–°–ø–æ—Å–æ–± –ø–ª–∞–≤–Ω–æ–π —Å–µ–Ω—Å—ã –ü–ö', gradient: 'linear-gradient(135deg, #4facfe, #00f2fe)' },
            { id: 'opt', icon: 'üì±', name: '–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞', gradient: 'linear-gradient(135deg, #fa709a, #fee140)' },
            { id: 'reg', icon: 'üîß', name: '–†–µ–≥–µ–¥–∏—Ç—ã –¥–ª—è —Å–µ–Ω—Å—ã', gradient: 'linear-gradient(135deg, #30cfd0, #330867)' },
            { id: 'set', icon: 'üì±', name: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–æ –∏–¥–µ–∞–ª–∞', gradient: 'linear-gradient(135deg, #a8edea, #fed6e3)' }
        ];

        function getParams() {
            const url = new URLSearchParams(window.location.search);
            USER_ID = url.get('user_id') || '';
            CUSTOM_ID = url.get('custom_id') || '';
            
            // –ü–û–õ–£–ß–ê–ï–ú –ò–ù–í–ï–ù–¢–ê–†–¨ –ò–ó URL (–° –°–ï–†–í–ï–†–ê!)
            const inventoryParam = url.get('inventory');
            if (inventoryParam) {
                try {
                    INVENTORY = JSON.parse(decodeURIComponent(inventoryParam));
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è:', e);
                    INVENTORY = [];
                }
            }
            
            console.log('üì¶ –ú–æ–∏ –ø—Ä–µ–¥–º–µ—Ç—ã:', INVENTORY);
        }

        function renderInventory() {
            const container = document.getElementById('inventory');
            container.innerHTML = '';

            if (INVENTORY.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üì¶</div>
                        <div class="empty-title">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø—Ä–µ–¥–º–µ—Ç–æ–≤</div>
                        <div class="empty-desc">–ö—É–ø–∏—Ç–µ —Ç–æ–≤–∞—Ä—ã –≤ –º–∞–≥–∞–∑–∏–Ω–µ,<br>–∏ –æ–Ω–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</div>
                    </div>
                `;
                return;
            }

            INVENTORY.forEach((name, index) => {
                const item = ITEMS.find(i => i.name === name);
                if (!item) return;

                const div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `
                    <div class="item-header" style="background: ${item.gradient}">
                        <div class="item-number">#${index + 1}</div>
                        <span class="item-icon">${item.icon}</span>
                    </div>
                    <div class="item-body">
                        <div class="item-title">${item.name}</div>
                        <div class="item-desc">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞</div>
                        <button class="claim-btn" onclick="claimItem(${index}, '${name}')">
                            üì• –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        window.claimItem = function(index, name) {
            tg.showConfirm(`–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä "${name}"?\n\n–¢–æ–≤–∞—Ä –±—É–¥–µ—Ç –≤—ã–¥–∞–Ω –≤–∞–º –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!`, ok => {
                if (ok) {
                    tg.sendData(JSON.stringify({
                        action: 'claim',
                        item_name: name,
                        item_index: index,
                        user_id: USER_ID,
                        custom_id: CUSTOM_ID
                    }));

                    showToast('success', `‚úÖ –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–¥–∞—á—É "${name}" –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!`);
                    tg.HapticFeedback.notificationOccurred('success');
                    setTimeout(() => tg.close(), 1500);
                }
            });
        };

        function showToast(type, text) {
            const toast = document.getElementById('toast');
            toast.className = `toast ${type} show`;
            document.getElementById('toastIcon').textContent = type === 'success' ? '‚úÖ' : '‚ùå';
            document.getElementById('toastText').textContent = text;
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        getParams();
        renderInventory();
        setTimeout(() => document.getElementById('loader').classList.add('hidden'), 500);

        tg.MainButton.setText('–ó–∞–∫—Ä—ã—Ç—å');
        tg.MainButton.show();
        tg.MainButton.onClick(() => tg.close());
    </script>
</body>
</html>
